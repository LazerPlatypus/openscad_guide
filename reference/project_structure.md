# Project Structure - Quick Reference

**Last Updated:** 2026-02-19
**Status:** Draft
**Why this structure?** See [Explanation](../explanation/why_these_conventions.md#project-structure)

---

## Canonical Project Layout (Physical Design Projects)

Use this layout for OpenSCAD projects that produce printable parts.

```
project_name/
├── README.md                    # Project overview + minimum OpenSCAD version
├── Makefile                     # Build automation entry point
├── .gitignore                   # Ignore generated files
├── .openscad_docsgen_rc         # openscad_docsgen configuration
├── config.scad                  # Global constants + preview/export config
│
├── parts/                       # Printable part source files (STL targets)
│   ├── part_one.scad
│   └── part_two.scad
│
├── assemblies/                  # Composed views / fit checks / docs renders
│   ├── assembly_main.scad
│   └── assembly_alt.scad
│
├── tools/                       # Reusable geometry-building modules for parts
│   ├── mount.scad
│   └── attachment.scad
│
├── hardware/                    # Reference hardware models/helpers
│   ├── bolt.scad
│   └── screw.scad
│
├── deps/                        # External dependencies (submodules/vendor)
│   └── coord_kit/
│
├── scripts/                     # Build scripts (called by Makefile)
│   ├── export_all.sh
│   ├── export_part.sh
│   ├── render_images.sh
│   ├── generate_docs.sh
│   └── setup.sh
│
├── build/                       # Generated output (gitignored)
│   ├── stl/                     # STL output from parts/
│   └── images/                  # Render output (often from assemblies/ + examples)
│
└── docs/                        # Documentation
    ├── README.md                # Docs index
    ├── assembly_instructions.md # Hand-written
    ├── bom.md                   # Hand-written
    └── api/                     # Generated by openscad_docsgen
```

---

## Canonical Library Layout

Use this layout for reusable libraries consumed by other projects.

```
library_name/
├── README.md
├── LICENSE
├── Makefile
├── .gitignore
├── .openscad_docsgen_rc
├── core.scad                    # Main include entry point
│
├── src/                         # Library source
├── deps/                        # Vendored dependencies
├── scripts/                     # setup/docs/render/test scripts
├── docs/                        # docs/src or docs/api generated output
└── build/                       # Generated files (gitignored)
```

---

## Directory Rules (Projects)

### `parts/`
- Primary source of printable geometry.
- `scripts/export_all.sh` should export from this directory to `build/stl/`.
- Files should render unconditionally when opened in OpenSCAD.

### `assemblies/`
- Used for composition, fit checks, and documentation imagery.
- Do **not** treat as STL export targets by default.
- Files should render unconditionally when opened in OpenSCAD.

### `tools/`
- Reusable building blocks used by `parts/`.
- Often helper/composition modules rather than directly printable final geometry.
- Documented like other source files because they are part of project API surface.

### `hardware/`
- Hardware reference geometry and helpers.
- Useful for fit checks, previews, and example renders.

### `config.scad`
- Holds project-wide constants and render/export switches.
- Typical pattern:
  - `PREVIEW_FN`
  - `EXPORT_FN`
  - `EXPORT_MODE`
  - `$fn = EXPORT_MODE ? EXPORT_FN : PREVIEW_FN;`

---

## Build Workflow Contract

### Makefile role
- Provide a simple command interface (`make`, `make docs`, `make images`, `make clean`).
- Delegate implementation details to scripts in `scripts/`.

### Script role
Recommended scripts for projects:
- `export_all.sh` - export all STL targets from `parts/`
- `export_part.sh` - export one STL with optional overrides (`VAR=value`)
- `render_images.sh` - generate docs images
- `generate_docs.sh` - run openscad_docsgen over project source dirs
- `setup.sh` - local setup (venv/tools)

### Documentation generation scope
- Generate docs from `parts/`, `assemblies/`, `tools/`, `hardware/`.
- Output generated docs to `docs/api/`.

---

## `.openscad_docsgen_rc` Baseline

Use these keys as default project baseline:

```plaintext
DocsDirectory: docs/api
TargetProfile: wiki
ProjectName: your_project
GenerateDocs: Files, ToC, Index, Topics, CheatSheet
```

Use `TargetProfile: wiki` for better VS Code markdown visualization compatibility.

---

## Minimum OpenSCAD Version

Each project should declare a minimum OpenSCAD version in `README.md`.

- Prefer explicit version strings, e.g. `2026.02.10+`
- Update minimum version when adopting newer snapshot features

---

## `.gitignore` Baseline

```gitignore
# Generated output
build/

# Python tooling
.venv/
__pycache__/

# OS/editor files
.DS_Store
Thumbs.db

# OpenSCAD temp
*.gch
*.bak
```

---

## Quick Checklist

**New project:**
- [ ] Use domain layout: `parts/`, `assemblies/`, `tools/`, `hardware/`
- [ ] Add `config.scad` with preview/export mode controls
- [ ] Ensure project files render unconditionally when opened directly
- [ ] Keep Makefile script-first (thin orchestration layer)
- [ ] Add script set: export, images, docs, setup
- [ ] Configure docsgen with `TargetProfile: wiki`
- [ ] Generate docs into `docs/api/`
- [ ] Put generated output in `build/` and ignore it
- [ ] Declare minimum OpenSCAD version in `README.md`

---

## Next Steps

- See [File Organization](file_organization.md) for per-file structure
- See [Documentation Reference](documentation.md) for docs block requirements
- See [Why These Conventions](../explanation/why_these_conventions.md#project-structure) for rationale
